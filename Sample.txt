Initial changes.

Modifed from forked branch.